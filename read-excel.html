<!DOCTYPE html>
<html lang="en" class="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Excel Viewer</title>
  <!-- Tailwind Play CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    // Enable class-based dark mode
    tailwind.config = {
      darkMode: 'class',
    };
  </script>
  <!-- SheetJS for Excel parsing -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
</head>
<body class="dark bg-black text-white h-screen overflow-hidden">
  <!-- File Upload -->
  <div class="p-4">
    <input type="file" id="file-input" accept=".xlsx, .xls" class="bg-gray-800 text-white p-2 rounded" />
  </div>
  <!-- Frames Container -->
  <div class="flex" style="height: calc(100vh - 64px);">
    <!-- Left Frame (10%) -->
    <div id="left-frame" class="border-r border-gray-700 overflow-auto" style="width: 10%;">
      <!-- First-column values will appear here -->
    </div>
    <!-- Right Frame (90%) -->
    <div id="right-frame" class="p-4 overflow-auto" style="width: 90%;">
      <!-- Font size controls -->
      <div class="flex items-center mb-4 space-x-2">
        <button id="decrease-font" class="px-2 py-1 border border-white rounded">-</button>
        <button id="increase-font" class="px-2 py-1 border border-white rounded">+</button>
      </div>
      <!-- Detail container for other columns -->
      <div id="detail-container" class="space-y-2">
      </div>
    </div>
  </div>

  <script>
    let data = [];
    let currentIndex = 0;
    let fontSize = 16;

    const fileInput = document.getElementById('file-input');
    const leftFrame = document.getElementById('left-frame');
    const detailContainer = document.getElementById('detail-container');
    const increaseFontBtn = document.getElementById('increase-font');
    const decreaseFontBtn = document.getElementById('decrease-font');

    fileInput.addEventListener('change', handleFile);
    increaseFontBtn.addEventListener('click', () => adjustFont(2));
    decreaseFontBtn.addEventListener('click', () => adjustFont(-2));
    document.addEventListener('keydown', handleNavigation);

    function handleFile(e) {
      const file = e.target.files[0];
      const reader = new FileReader();
      reader.onload = function(event) {
        const wb = XLSX.read(event.target.result, { type: 'array' });
        const ws = wb.Sheets[wb.SheetNames[0]];
        data = XLSX.utils.sheet_to_json(ws, { header: 1 });
        renderList();
        renderDetail(0);
      };
      reader.readAsArrayBuffer(file);
    }

    function renderList() {
      leftFrame.innerHTML = '';
      data.forEach((row, index) => {
        const cell = document.createElement('div');
        cell.textContent = row[0] || '';
        cell.className = 'p-2 cursor-pointer hover:bg-gray-800';
        cell.addEventListener('click', () => selectRow(index));
        leftFrame.appendChild(cell);
      });
      highlightSelected();
    }

    function renderDetail(index) {
      currentIndex = index;
      detailContainer.innerHTML = '';
      const row = data[index] || [];
      row.forEach((cell, idx) => {
        const header = data[0][idx] || `Column ${idx + 1}`;
        const block = document.createElement('div');
        block.textContent = `${header}: ${cell}`;
        block.className = 'p-2 border border-gray-700 rounded';
        block.style.fontSize = `${fontSize}px`;
        detailContainer.appendChild(block);
      });
      highlightSelected();
    }

    function selectRow(index) {
      renderDetail(index);
    }

    function adjustFont(delta) {
      fontSize = Math.max(10, fontSize + delta);
      Array.from(detailContainer.children).forEach(block => {
        block.style.fontSize = `${fontSize}px`;
      });
    }

    function handleNavigation(e) {
      if (!data.length) return;
      if (e.key === 'ArrowRight' || e.key === ' ') {
        e.preventDefault();
        const next = Math.min(data.length - 1, currentIndex + 1);
        renderDetail(next);
      }
      if (e.key === 'ArrowLeft') {
        e.preventDefault();
        const prev = Math.max(0, currentIndex - 1);
        renderDetail(prev);
      }
    }

    function highlightSelected() {
      Array.from(leftFrame.children).forEach((child, idx) => {
        child.classList.toggle('bg-gray-800', idx === currentIndex);
      });
    }
  </script>
</body>
</html>
